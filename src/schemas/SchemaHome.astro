---
import { getCollection } from 'astro:content';

// Fetch FAQs for homepage schema (both general and homepage-specific)
const allFaqs = await getCollection('faq');

// Get FAQs to include in homepage schema
// Include: showOnHomepage FAQs + first 5 general FAQs
const homepageFaqs = allFaqs
    .filter(faq => faq.data.showOnHomepage === true)
    .sort((a, b) => a.data.order - b.data.order);

const generalFaqs = allFaqs
    .filter(faq => faq.data.category === 'general' && !faq.data.showOnHomepage)
    .sort((a, b) => a.data.order - b.data.order)
    .slice(0, 5);

// Combine for schema
const schemaFaqs = [...generalFaqs, ...homepageFaqs];

// Generate FAQ schema data
const faqSchemaData = {
    '@context': 'https://schema.org',
    '@type': 'FAQPage',
    'mainEntity': schemaFaqs.map(faq => ({
        '@type': 'Question',
        'name': faq.data.title,
        'acceptedAnswer': {
            '@type': 'Answer',
            'text': faq.data.shortAnswer || faq.data.teaser || faq.data.description || ''
        }
    }))
};
---

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "MedicalBusiness",
        "name": "Hypnosetherapie Bern – Janine Aerni",
        "image": {
            "@type": "ImageObject",
            "url": "https://bern-hypnose.ch/bern-hypnose-janine-aerni.jpg",
            "width": 800,
            "height": 800,
            "caption": "Janine Aerni – Diplomierte Hypnosetherapeutin in Bern"
        },
        "logo": "https://bern-hypnose.ch/bern-hypnose-janine-aerni.jpg",
        "description": "Hypnosetherapie Bern – Janine Aerni. Professionelle Hypnosetherapie in Bern, um Stress, Ängste, Phobien und mehr zu überwinden. Erfahre, wie Hypnose dir helfen kann, ein gesünderes und ausgeglicheneres Leben zu führen.",
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "Eigerstrasse 56",
            "addressLocality": "Bern",
            "postalCode": "3007",
            "addressCountry": "CH"
        },
        "geo": {
            "@type": "GeoCoordinates",
            "latitude": "46.9400119148607",
            "longitude": "7.436508173013693"
        },
        "telephone": "+41 79 833 03 85",
        "contactPoint": {
            "@type": "ContactPoint",
            "contactType": "Customer Service",
            "telephone": "+41 79 833 03 85",
            "email": "janine@bern-hypnose.ch"
        },
        "url": "https://bern-hypnose.ch",
        "priceRange": "120 CHF - 150 CHF",
        "openingHours": "Mo,Tu,We,Th,Fr 07:00-19:00",
        "sameAs": [
            "https://www.facebook.com/profile.php?id=61564940341284",
            "https://www.linkedin.com/in/janine-aerni-b7452a321/",
            "https://www.instagram.com/janineaerni/"
        ],
        "founder": {
            "@type": "Person",
            "name": "Janine Aerni",
            "jobTitle": "Diplomierte Hypnosetherapeutin",
            "telephone": "+41 79 833 03 85",
            "email": "janine@bern-hypnose.ch",
            "knowsAbout": ["Hypnose", "Hypnosetherapie", "Rauchstopp mit Hypnose", "Hypnose für Ängste", "Hypnose für Selbstvertrauen"]
        },
        "areaServed": [
            { "@type": "Place", "name": "Bern" },
            { "@type": "Place", "name": "Köniz" },
            { "@type": "Place", "name": "Wabern" },
            { "@type": "Place", "name": "Liebefeld" },
            { "@type": "Place", "name": "Muri bei Bern" },
            { "@type": "Place", "name": "Ostermundigen" },
            { "@type": "Place", "name": "Ittigen" },
            { "@type": "Place", "name": "Bremgarten bei Bern" },
            { "@type": "Place", "name": "Kirchlindach" },
            { "@type": "Place", "name": "Wohlen bei Bern" }
        ],
        "aggregateRating": {
            "@type": "AggregateRating",
            "ratingValue": "5",
            "bestRating": "5",
            "ratingCount": "44"
        },
        "review": [
            {
                "@type": "Review",
                "author": { "@type": "Person", "name": "Claes Lennman" },
                "reviewBody": "Ich habe mich bei Janine von Anfang an verstanden, sicher und gut aufgehoben gefühlt. Während der Hypnosesitzung hatte ich den Eindruck, dass sie genau spürt, was ich gerade brauche, als würde sie zwischen den Zeilen lesen können.",
                "reviewRating": { "@type": "Rating", "ratingValue": "5", "bestRating": "5" },
                "url": "https://g.co/kgs/ddjY2rf"
            },
            {
                "@type": "Review",
                "author": { "@type": "Person", "name": "Nicole Engler" },
                "reviewBody": "Sehr beeindruckend und absolut empfehlenswert! Janine hat sich viel Zeit genommen, die Hypnose individuell auf mich abzustimmen, und ich habe mich von Anfang an wohlgefühlt.",
                "reviewRating": { "@type": "Rating", "ratingValue": "5", "bestRating": "5" },
                "url": "https://maps.app.goo.gl/7WBcEaDnA5W16v5p8"
            },
            {
                "@type": "Review",
                "author": { "@type": "Person", "name": "Joanna Wieruszewska" },
                "reviewBody": "Dank Janine durfte ich eine berührende, tiefe und aufschlussreise Reise in mich selbst erleben, die mich geprägt hat.",
                "reviewRating": { "@type": "Rating", "ratingValue": "5", "bestRating": "5" },
                "url": "https://maps.app.goo.gl/odUztZYBiiHmJUuL8"
            },
            {
                "@type": "Review",
                "author": { "@type": "Person", "name": "Paula Bozic" },
                "reviewBody": "Ich war wegen Durchschlafproblemen bei Janine. Seit der Hypnosetherapie bei Janine schlafe ich viel besser.",
                "reviewRating": { "@type": "Rating", "ratingValue": "5", "bestRating": "5" },
                "url": "https://maps.app.goo.gl/dVE5uGwXezAQ2TyV8"
            },
            {
                "@type": "Review",
                "author": { "@type": "Person", "name": "Lea Tschirren" },
                "reviewBody": "Die Therapie bei Janine Aerni hat unserer Tochter sehr gut getan. Janine Aerni hat eine sehr warme und einfühlsame Art.",
                "reviewRating": { "@type": "Rating", "ratingValue": "5", "bestRating": "5" },
                "url": "https://maps.app.goo.gl/ragLMPJzG8MMC7Lv9"
            }
        ],
        "hasMap": "https://maps.app.goo.gl/6ztgohYSpsWiT9CB8",
        "paymentAccepted": "Bargeld, TWINT, auf Rechnung",
        "hasOfferCatalog": {
            "@type": "OfferCatalog",
            "name": "Hypnosetherapie Dienstleistungen in Bern",
            "itemListElement": [
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Hypnosetherapie gegen Ängste und Phobien",
                        "description": "Professionelle Hypnosetherapie zur Überwindung von Ängsten, Phobien und Angststörungen in Bern"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Rauchstopp mit Hypnose",
                        "description": "Rauchentwöhnung durch Hypnosetherapie in Bern"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Hypnose gegen Stress und Burnout",
                        "description": "Stressbewältigung und Burnout-Prävention durch Hypnosetherapie"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Kinderhypnose",
                        "description": "Sanfte Hypnosetherapie für Kinder bei Ängsten und Blockaden"
                    }
                },
                {
                    "@type": "Offer",
                    "itemOffered": {
                        "@type": "Service",
                        "name": "Sporthypnose",
                        "description": "Mentales Training und Leistungssteigerung für Sportler durch Hypnose"
                    }
                }
            ]
        }
    }
</script>

<!-- FAQ Schema - Dynamically generated from content collection -->
<script type="application/ld+json" set:html={JSON.stringify(faqSchemaData)} />

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "Geführte Kurzhypnose App",
        "url": "https://bern-hypnose.ch/app/",
        "description": "Nimm dir einen ruhigen Moment Zeit, mach es dir bequem und lass dich von meiner App in einen Zustand tiefer Entspannung führen.",
        "applicationCategory": "LifestyleApplication",
        "operatingSystem": "Web",
        "offers": {
            "@type": "Offer",
            "price": "0.00",
            "priceCurrency": "CHF"
        },
        "author": {
            "@type": "Person",
            "name": "Janine Aerni"
        }
    }
</script>

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "BreadcrumbList",
        "itemListElement": [{
            "@type": "ListItem",
            "position": 1,
            "name": "Hypnosetherapie Bern",
            "item": "https://bern-hypnose.ch/"
        }]
    }
</script>
