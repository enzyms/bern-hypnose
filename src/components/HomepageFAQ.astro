---
import { getCollection } from 'astro:content';

// Fetch FAQs marked for homepage, sorted by order
const faqs = (await getCollection('faq')).filter((faq) => faq.data.showOnHomepage === true).sort((a, b) => a.data.order - b.data.order);
---

<section class="prose sm:prose-lg mt-12">
    <h2>Häufige Fragen zur Hypnosetherapie Bern</h2>

    <div class="not-prose border-gray-400 border-b">
        {
            faqs.map((faq) => (
                <details class="group border-t border-gray-400">
                    <summary class="font-bold text-lg cursor-pointer text-main hover:text-red-700 px-1 py-5 list-none flex items-center justify-between">
                        <span>{faq.data.title}</span>
                        <span class="text-red-600 transform transition-transform group-open:rotate-180">▼</span>
                    </summary>
                    <div class="mt-3 mb-6 text-gray-900 prose px-1">
                        <p set:html={faq.data.shortAnswer} />
                        {faq.data.linkTo && (
                            <a href={faq.data.linkTo} class="text-red-700 hover:text-red-800 font-medium">
                                → {faq.data.linkText || 'Mehr erfahren'}
                            </a>
                        )}
                    </div>
                </details>
            ))
        }
    </div>

    <a
        href="/was-ist-hypnose/"
        class="not-prose inline-flex my-12 items-center justify-center px-6 py-3 text-base leading-tight font-bold text-red-700 bg-transparent border border-red-700 rounded-full transition hover:bg-red-500 hover:text-red-50"
    >
        Alle häufigen Fragen
    </a>
</section>
